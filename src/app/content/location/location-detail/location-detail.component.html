<div fxLayout="row"
>

  <div fxFlex="100">
    <mat-card class="mat-card-top">
      <mat-card-title>
        <mat-icon>details</mat-icon>
        {{'general.menu.location.detail' | translate}}
      </mat-card-title>
      <mat-card-subtitle></mat-card-subtitle>

      <mat-card-content *ngIf="location && categories$ && members$; else loadingTemplate">

        <mat-tab-group *ngIf="categories$ | async as categories; else loadingTemplate"
                       [dynamicHeight]="true">

          <mat-tab label="{{'general.locations.edit.mainTitle' | translate}}">
            <div fxLayout="column"
                 fxLayout.gt-sm="row"
                 fxLayoutGap="30px">

              <div fxFlex.gt-sm="30">
                <location-detail-main [location]="location"
                                      [categories]="categories">
                </location-detail-main>
              </div>

              <div fxFlex.gt-sm="35">
                <mat-card>
                  <mat-card-title>{{'general.locations.edit.photoTitle' | translate}}</mat-card-title>
                  <mat-card-content>
                    <img *ngIf="locationImage | async as image; else loadingTemplate"
                         mat-card-image
                         [src]="image.downloadURL">
                  </mat-card-content>
                </mat-card>

                <location-detail-contact [showLinks]="false"
                                         [members]="members$ | async"
                                         [location]="location">
                </location-detail-contact>
              </div>

              <div fxFlex.gt-sm="35">
                <mat-card>
                  <mat-card-title>{{'general.locations.edit.mapTitle' | translate}}</mat-card-title>
                  <mat-card-content>
                    <location-detail-map [location]="location"></location-detail-map>
                  </mat-card-content>
                </mat-card>
              </div>

            </div>
          </mat-tab>

          <mat-tab label="{{'general.locations.detail.assignedArticlesTitle' | translate}}">
            <div fxLayout="column"
                 fxLayout.gt-sm="row"
                 fxLayoutGap="10px">

              <div fxFlex.gt-sm="50" *ngIf="articles$ | async as articles; else loadingTemplate">
                <h3>{{'general.locations.detail.assignedArticles' | translate}}</h3>

                <p *ngIf="(articles | filterBy: ['assignedLocation'] : location.id).length === 0">
                  {{ 'general.locations.detail.noAssignedArticles' | translate }}
                </p>

                <ul>
                  <li *ngFor="let article of articles | filterBy: ['assignedLocation'] : location.id | orderBy: ['-articleDate']">
                    <a [routerLink]="['/articles/detail', article.id]">
                    {{article.title}} {{article.articleDate.seconds *1000 | date: 'dd.MM.yy'}}
                    </a>
                  </li>
                </ul>
              </div>

              <div fxFlex.gt-sm="50" *ngIf="matches$ | async as matches; else loadingTemplate">
                <h3>{{'general.locations.detail.assignedMatches' | translate}}</h3>

                <p *ngIf="(matches | filterBy: ['assignedLocation'] : location.id).length === 0">
                  {{ 'general.locations.detail.noAssignedMatches' | translate }}
                </p>

                <ul>
                  <li *ngFor="let match of matches | filterBy: ['assignedLocation'] : location.id | orderBy: ['-startDate']">
                    {{match.startDate | date: 'dd.MM.yy'}}: {{match.title}}
                  </li>
                </ul>
              </div>
            </div>
          </mat-tab>

          <mat-tab label="{{'general.locations.media.list' | translate}}">
            <div fxLayout="row">
              <div fxFlex.gt-sm="30" fxFlex.gt-xs="100" fxFlex="100">
                ToDo
                <!-- <location-detail-media [location]="location"></location-detail-media>-->
              </div>
            </div>
          </mat-tab>
        </mat-tab-group>
      </mat-card-content>

      <mat-card-actions>
        <div fxLayout="column"
             fxLayoutGap="10px"
             fxLayout.gt-sm="row">
          <a mat-raised-button color="primary" [routerLink]="['/locations']">
            {{'general.menu.location.list' | translate}}
          </a>
          <a mat-raised-button color="accent" [routerLink]="['/locations/edit', location.id]">
            {{'general.edit' | translate }}
          </a>
          <a mat-raised-button color="warn" (click)="removeLocation(location)">
            {{'general.delete' | translate }}
          </a>
        </div>
      </mat-card-actions>
    </mat-card>
  </div>
</div>

<ng-template #loadingTemplate>
  <loading-indicator></loading-indicator>
</ng-template>

<ng-template #noImageTemplate>
  <p>{{ 'general.locations.edit.noLogo' | translate }}</p>
</ng-template>
