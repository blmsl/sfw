<mat-card *ngIf="match">
  <mat-card-title>
    {{ 'general.matches.edit.title' | translate }}
  </mat-card-title>
  <mat-card-subtitle></mat-card-subtitle>
  <mat-card-content [formGroup]="form">

    <mat-tab-group [dynamicHeight]="true">
      <mat-tab [label]="'general.matches.edit.main' | translate">
        <div fxLayout="column"
             fxLayout.gt-sm="row"
             fxLayoutGap="10px">
          <div fxFlex.gt-sm="70">
            <match-edit-main [form]="form"
                             [categories]="categories$ | async"
                             [teams]="teams$ | async"
                             [seasons]="seasons$ | async"
                             [locations]="locations$ | async">
            </match-edit-main>
          </div>
          <div fxFlex.gt-sm="30">
            <match-edit-result [otherMatchEventList]="otherMatchEventList"
                               [form]="form.get('result')"></match-edit-result>
          </div>
        </div>
      </mat-tab>
      <mat-tab [label]="'general.matches.edit.startingEleven.title' | translate">
        <p *ngIf="!form.get('assignedTeam').value">{{'general.matches.edit.noAssignedTeam' | translate}}</p>

        <match-edit-formation *ngIf="assignedTeam && assignedMembers; else loadingTemplate"
                              [match]="match"
                              [assignedTeamPlayers]="assignedMembers">
        </match-edit-formation>
      </mat-tab>
      <mat-tab
        [label]="('general.matches.edit.articles' | translate) + ' & ' + ('general.matches.edit.match' | translate)">
        <div fxLayout="column"
             fxLayout.gt-sm="row"
             fxLayoutGap="10px">
          <div fxFlex.gt-sm="50">
            <match-edit-events [matchEvents]="match.assignedMatchEvents ? match.assignedMatchEvents : []"
                               [eventCategories]="matchEventCategories | orderBy: ['title']"
                               (changeOrder)="changeOrder($event)"
                               (deleteMatchEvent)="deleteMatchEvent($event)">
            </match-edit-events>

            <match-edit-event-form *ngIf="teams$ | async as teams"
                                   [assignedTeam]="(teams | filterBy: ['id']: match.assignedTeam)[0]"
                                   [eventCategories]="matchEventCategories | orderBy: ['title']"
                                   (createMatchEvent)="createMatchEvent(null)"
                                   (saveMatchEvent)="saveMatchEvent($event)">
            </match-edit-event-form>
          </div>

          <div fxFlex.gt-sm="50">
            <!-- ToDo: assign Articles to match -->
            <!--<match-edit-articles *ngIf="assignedArticles$ | async as assignedArticles; else loadingTemplate"
                                 [match]="match"
                                 [articles]="assignedArticles">
            </match-edit-articles>

            <match-edit-article-form *ngIf="notAssignedArticles$ | async as notAssignedArticles; else loadingTemplate"
                                     [match]="match"
                                     [notAssignedArticles]="notAssignedArticles">
            </match-edit-article-form>-->
          </div>
        </div>
      </mat-tab>
      <mat-tab [label]="'general.matches.edit.media' | translate">
        <!-- ToDo -->
        <ul>
          <li>Verlinkte VideoÂ´s (soccerwatch.tv, youtube, facebook etc)</li>
          <li>Verlinkte Fotos / Galerien (Link zu Facebook)</li>
          <li>Lokal hochgeladene Dateien</li>
        </ul>
      </mat-tab>
    </mat-tab-group>

  </mat-card-content>

  <mat-card-actions>
    <div fxLayout="column"
         fxLayout.gt-sm="row"
         fxLayoutGap="10px">
      <span></span>
      <span fxFlex=""></span>
      <button mat-raised-button
              color="primary"
              [routerLink]="['/matches']">
        {{'general.menu.matches.list' | translate}}
      </button>
      <button mat-raised-button
              color="accent"
              [routerLink]="['/matches/detail', match.id]">
        {{'general.detail' | translate }}
      </button>
      <button mat-raised-button
              color="warn"
              (click)="removeMatch(match)">
        {{'general.delete' | translate }}
      </button>
    </div>
  </mat-card-actions>

</mat-card>

<ng-template #loadingTemplate>
  <loading-indicator></loading-indicator>
</ng-template>
