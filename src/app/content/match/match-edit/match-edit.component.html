<mat-card *ngIf="match">
  <mat-card-title>
    {{ 'general.matches.edit.title' | translate }}
  </mat-card-title>
  <mat-card-subtitle></mat-card-subtitle>
  <mat-card-content [formGroup]="form">
    <div *ngIf="teams$ | async as teams; else loadingTemplate">
      <mat-tab-group [dynamicHeight]="true">
        <mat-tab [label]="'general.matches.edit.main' | translate">
          <div fxLayout="column"
               fxLayout.gt-sm="row"
               fxLayoutGap="10px">
            <div fxFlex.gt-sm="40">
              <match-edit-main [form]="form"
                               [categories]="categories$ | async"
                               [teams]="teams"
                               [seasons]="seasons$ | async"
                               [locations]="locations$ | async">
              </match-edit-main>
            </div>
            <div>
              <pre>{{match | json}}</pre>
            </div>
          </div>
        </mat-tab>
        <mat-tab [label]="'general.matches.edit.startingEleven.title' | translate">

          <p *ngIf="!form.get('assignedTeam').value">{{'general.matches.edit.noAssignedTeam' | translate}}</p>

          <match-edit-starting-eleven *ngIf="form.get('assignedTeam').value"
                                      [form]="form"
                                      (addPlayerToStartingEleven)="addPlayerToStartingEleven($event)"
                                      [team]="(teams | filterBy: ['id'] : form.get('assignedTeam').value)[0]">
          </match-edit-starting-eleven>
        </mat-tab>
        <mat-tab
          [label]="('general.matches.edit.articles' | translate) + ' & ' + ('general.matches.edit.match' | translate)">
          <div fxLayout="column"
               *ngIf="articles$ |async as articles; else loadingTemplate"
               fxLayout.gt-sm="row"
               fxLayoutGap="10px">
            <div fxFlex.gt-sm="50">
              <match-edit-events></match-edit-events>
            </div>

            <div fxFlex.gt-sm="50">
              <div fxLayout="column"
                   fxLayout.gt-sm="row"
                   fxLayoutGap="10px">
                <div fxFlex="50">
                  <article-card *ngFor="let article of articles | filterBy: ['assignedMatch'] : match.id"
                                [article]="article"></article-card>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>
        <mat-tab [label]="'general.matches.edit.media' | translate">
          <ul>
            <li>Verlinkte VideoÂ´s (soccerwatch.tv, youtube, facebook etc)</li>
            <li>Verlinkte Fotos / Galerien (Link zu Facebook</li>
            <li>Lokal hochgeladene Dateien</li>
          </ul>
        </mat-tab>
      </mat-tab-group>
    </div>

  </mat-card-content>

  <mat-card-actions>
    <div fxLayout="column"
         fxLayout.gt-sm="row"
         fxLayoutGap="10px">
      <span></span>
      <span fxFlex=""></span>
      <button mat-raised-button
              color="primary"
              [routerLink]="['/matches']">
        {{'general.menu.matches.list' | translate}}
      </button>
      <button mat-raised-button
              color="accent"
              [routerLink]="['/matches/detail', match.id]">
        {{'general.detail' | translate }}
      </button>
      <button mat-raised-button
              color="warn"
              (click)="removeMatch(match)">
        {{'general.delete' | translate }}
      </button>
    </div>
  </mat-card-actions>

</mat-card>

<ng-template #loadingTemplate>
  <loading-indicator></loading-indicator>
</ng-template>
