<div fxLayout.gt-sm="row"
     fxLayout="column"
     *ngIf="seasons$ | async as seasons; else loadingTemplate">

    <mat-card fxFlex.gt-sm="33,3333">
        <mat-card-title>
            {{'general.members.edit.assignedAsPlayer' | translate}}
        </mat-card-title>
        <mat-card-subtitle></mat-card-subtitle>
        <mat-card-content>

            <p *ngIf="(teams | isTeamMemberFilter : member : 'assignedPlayers').length === 0">
                {{'general.members.edit.notAssignedToAnyTeams' | translate}}
            </p>

            <div *ngIf="(teams | isTeamMemberFilter : member : 'assignedPlayers').length !== 0">
                <div *ngFor="let season of seasons | seasonsWithTeamsFilter: (teams | isTeamMemberFilter : member : 'assignedPlayers')">
                    <h3>{{season.title}}</h3>

                    <mat-list dense *ngIf="(teams | isTeamMemberFilter : member : 'assignedPlayers'
                    | orderBy: ['subTitle', 'title'] | filterBy: ['assignedSeason'] : season.id).length > 0">

                        <mat-list-item *ngFor="let team of teams | isTeamMemberFilter : member : 'assignedPlayers'
                                | orderBy: ['subTitle', 'title'] | filterBy: ['assignedSeason'] : season.id">
                            <a [routerLink]="['/teams/detail', team.id]">{{team.title}} {{team.subTitle}}</a>
                            <span fxFlex></span>
                            <button mat-icon-button
                                    (click)="deleteMemberFromTeam.emit({team: team, member: member})">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </mat-list-item>

                    </mat-list>
                </div>
            </div>

        </mat-card-content>
    </mat-card>


    <mat-card fxFlex.gt-sm="33,3333">
        <mat-card-title>
            <mat-icon>list</mat-icon>
            {{'general.members.detail.functions.inTeamManagement' | translate}}
        </mat-card-title>
        <mat-card-subtitle></mat-card-subtitle>
        <mat-card-content>

            <p *ngIf="(teams | isTeamManagementFilter : member).length === 0">
                {{'general.members.edit.notAssignedToAnyTeamManagements' | translate}}
            </p>

            <div *ngIf="(teams | isTeamManagementFilter : member).length !== 0">
                <div *ngFor="let season of seasons | seasonsWithTeamsFilter: (teams | isTeamManagementFilter : member)">
                    <h3>{{season.title}}</h3>

                    <mat-list dense
                              *ngIf="(teams | isTeamManagementFilter : member | orderBy: ['subTitle', 'title'] | filterBy: ['assignedSeason'] : season.id).length > 0">
                        <mat-list-item
                                *ngFor="let team of teams | isTeamManagementFilter : member | orderBy: ['subTitle', 'title'] | filterBy: ['assignedSeason'] : season.id">
                            <a [routerLink]="['/teams/detail', team.id]">{{team.title}} {{team.subTitle}}</a>
                            <span fxFlex></span>
                            <span *ngFor="let position of team.assignedPositions | filterBy: ['assignedMember'] : member.id; let last = last">{{position.position}}
                                <span *ngIf="!last">, </span>
                            </span>
                            <span fxFlex></span>
                            <button mat-icon-button
                                    (click)="deleteMemberFromTeamManagement.emit({team: team, member: member})">
                                <mat-icon>delete</mat-icon>
                            </button>
                        </mat-list-item>
                    </mat-list>
                </div>
            </div>

        </mat-card-content>
    </mat-card>


    <mat-card fxFlex.gt-sm="33,3333">
        <mat-card-title>
            <mat-icon>list</mat-icon>
            {{'general.members.detail.functions.inClubManagement' | translate}}
        </mat-card-title>
        <mat-card-subtitle></mat-card-subtitle>
        <mat-card-content>
            <!-- *ngIf="clubs$ | async as club; else loadingTemplate" -->
            <pre>{{clubs$ | async | json}}</pre>
            <!--<mat-list  dense>
                <mat-list-item *ngFor="let position of getMemberPositionsInClubs(clubs)">
                    <h4 fxFlex="40"
                        *ngFor="let category of categories | filterBy: ['id'] :position.assignedPosition">
                        {{category.title}}
                    </h4>
                    <p fxFlex="60">
                        <span *ngIf="!position.endDate">{{'general.since' | translate}}</span>
                        <span *ngIf="position.endDate">{{'general.from' | translate}}</span>
                        {{position.startDate | date: 'dd.MM.yy'}}
                        {{position.endDate ? (' bis ' + position.endDate | date: 'dd.MM.yy') : ''}}
                    </p>
                </mat-list-item>
            </mat-list>-->
        </mat-card-content>
    </mat-card>

</div>

<ng-template #loadingTemplate>
    <loading-indicator></loading-indicator>
</ng-template>
